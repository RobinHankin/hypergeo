test_that("test suite aae", {

    ## Some random tests that check hypergeo() with *complex* values for
    ## A, B, C.  numerical results from sage 10.4

sage_session_cut_and_pasted <- '
sage: list(hypergeometric([0.3 + 0.3*I, -0.2 -0.12313*I],[2-0.345*I], 1.2 + p*0.1*I) for p in range(-8,8))
[0.929507112029331 - 0.0560673659654640*I,
 0.935559723861968 - 0.0605290663676108*I,
 0.942082466852257 - 0.0650326156128549*I,
 0.949162347417944 - 0.0695642208599249*I,
 0.956917730967192 - 0.0741032010639393*I,
 0.965518202449759 - 0.0786196297362217*I,
 0.975224453409326 - 0.0830750643507708*I,
 0.986474007918228 - 0.0874464600542382*I,
 1.00004162109607 - 0.0918731687225795*I,
 1.01579691723066 - 0.0771912389639112*I,
 1.02294104397322 - 0.0734337736965516*I,
 1.02954854456686 - 0.0699519034740910*I,
 1.03570905167356 - 0.0666617348191262*I,
 1.04149450661346 - 0.0635156703389541*I,
 1.04696054196369 - 0.0604847297053601*I,
 1.05215044454376 - 0.0575499147463523*I]
sage: 
'


    ## Use emacs to massage the sage output into R idiom, results below:

sage_output_hypergeometric_R_format <- c(
0.929507112029331 - 0.0560673659654640 * 1i,
 0.935559723861968 - 0.0605290663676108 * 1i,
 0.942082466852257 - 0.0650326156128549 * 1i,
 0.949162347417944 - 0.0695642208599249 * 1i,
 0.956917730967192 - 0.0741032010639393 * 1i,
 0.965518202449759 - 0.0786196297362217 * 1i,
 0.975224453409326 - 0.0830750643507708 * 1i,
 0.986474007918228 - 0.0874464600542382 * 1i,
 1.00004162109607 - 0.0918731687225795 * 1i,
 1.01579691723066 - 0.0771912389639112 * 1i,
 1.02294104397322 - 0.0734337736965516 * 1i,
 1.02954854456686 - 0.0699519034740910 * 1i,
 1.03570905167356 - 0.0666617348191262 * 1i,
 1.04149450661346 - 0.0635156703389541 * 1i,
 1.04696054196369 - 0.0604847297053601 * 1i,
 1.05215044454376 - 0.0575499147463523 * 1i)



## now perform the actual comparison:
p <- seq(from = -8, to=7, by=1)  # NB off-by-one issue
R_output <- hypergeo(0.3 + 0.3i, -0.2 -0.12313i, 2-0.345i, 1.2 + p*0.1i)

expect_true(all(abs(sage_output_hypergeometric_R_format - R_output) < 1e-10))

} )

